import RPi.GPIO as GPIO
import pygame

# motor setup
 
GPIO.setmode(GPIO.BOARD)
GPIO.setwarnings(False)
 
m1a = 11
m1b = 13
m1 = 15

m2a = 29
m2b = 31
m2 = 33

GPIO.setup(m1a,GPIO.OUT)
GPIO.setup(m1b,GPIO.OUT)
GPIO.setup(m1,GPIO.OUT)
 
GPIO.setup(m2a,GPIO.OUT)
GPIO.setup(m2b,GPIO.OUT)
GPIO.setup(m2,GPIO.OUT)

#joystick setup

pygame.init()
joystick_count = pygame.joystick.get_count()

for i in range(joystick_count):
    joystick = pygame.joystick.Joystick(i)
    joystick.init()


#joystick input values converted to electrical output

while True:
    pygame.event.pump()
    right = joystick.get_axis(1)
    rh = joystick.get_axis(0)
    left = joystick.get_axis(4)
    lh = joystick.get_axis(3)
    
    print(right)
    print(rh)
    print(left)
    print(lh)

    #forward
    while right > 0.2 and left > 0.2:
        GPIO.output(m1a, GPIO.HIGH)
        GPIO.output(m1b, GPIO.LOW)
        GPIO.output(m1, GPIO.HIGH)

        GPIO.output(m2a, GPIO.HIGH)
        GPIO.output(m2b, GPIO.LOW)
        GPIO.output(m2, GPIO.HIGH)

        pygame.event.pump()
    
    GPIO.output(m1, GPIO.LOW)
    GPIO.output(m2, GPIO.LOW)
    
    pygame.event.pump()


    #backward
    while right < -0.2 and left < -0.2:
        GPIO.output(m1a, GPIO.LOW)
        GPIO.output(m1b, GPIO.HIGH)
        GPIO.output(m1, GPIO.HIGH)

        GPIO.output(m2a, GPIO.LOW)
        GPIO.output(m2b, GPIO.HIGH)
        GPIO.output(m2, GPIO.HIGH)

        pygame.event.pump()

    GPIO.output(m1, GPIO.LOW)
    GPIO.output(m2, GPIO.LOW)
    
    pygame.event.pump()


    #clockwise about origin
    while left > 0.2 and right < -0.2:

        GPIO.output(m1a, GPIO.LOW)
        GPIO.output(m1b, GPIO.HIGH)
        GPIO.output(m1, GPIO.HIGH)

        GPIO.output(m2a, GPIO.HIGH)
        GPIO.output(m2b, GPIO.LOW)
        GPIO.output(m2, GPIO.HIGH)

        pygame.event.pump()

    GPIO.output(m1, GPIO.LOW)
    GPIO.output(m2, GPIO.LOW)

    pygame.event.pump()


    #counterclockwise about origin
    while left < -0.2 and right > 0.2:

        GPIO.output(m1a, GPIO.LOW)
        GPIO.output(m1b, GPIO.HIGH)
        GPIO.output(m1, GPIO.HIGH)

        GPIO.output(m2a, GPIO.LOW)
        GPIO.output(m2b, GPIO.HIGH)
        GPIO.output(m2, GPIO.HIGH)

        pygame.event.pump()

    GPIO.output(m1, GPIO.LOW)
    GPIO.output(m2, GPIO.LOW)

    pygame.event.pump()


    #turn right forward
    while right > 0.2 and -0.2 < left < 0.2:

        GPIO.output(m2a, GPIO.HIGH)
        GPIO.output(m2b, GPIO.LOW)
        GPIO.output(m2, GPIO.HIGH)

        pygame.event.pump()

    GPIO.output(m1, GPIO.LOW)
    GPIO.output(m2, GPIO.LOW)

    pygame.event.pump()


    #turn left forward
    while left > 0.2 and -0.2 < right < 0.2:
        
        GPIO.output(m1a, GPIO.HIGH)
        GPIO.output(m1b, GPIO.LOW)
        GPIO.output(m1, GPIO.HIGH)

        pygame.event.pump()

    GPIO.output(m1, GPIO.LOW)
    GPIO.output(m2, GPIO.LOW)

    pygame.event.pump()


    #turn right backward
    while right < -0.2 and -0.2 < left < 0.2:

        GPIO.output(m1a, GPIO.LOW)
        GPIO.output(m1b, GPIO.HIGH)
        GPIO.output(m1, GPIO.HIGH)

        pygame.event.pump()

    GPIO.output(m1, GPIO.LOW)
    GPIO.output(m2, GPIO.LOW)

    pygame.event.pump()


    #turn left backward
    while left < -0.2 and -0.2 < right < 0.2:

        GPIO.output(m2a, GPIO.LOW)
        GPIO.output(m2b, GPIO.HIGH)
        GPIO.output(m2, GPIO.HIGH)

        pygame.event.pump()

    GPIO.output(m1, GPIO.LOW)
    GPIO.output(m2, GPIO.LOW)
    
    pygame.event.pump()


GPIO.cleanup()
